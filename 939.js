"use strict";(globalThis.webpackChunknimus_cards=globalThis.webpackChunknimus_cards||[]).push([[939],{939:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var n=t(294),i=t(655),a=t(620),c=t(446),d=t(461),l=t(997),o=t(893);function r({removeDeck:e,cancelRemoval:s}){return(0,o.jsxs)(l.Z,{hide:s,children:[(0,o.jsx)("h3",{className:"modal-title",children:"Are you sure you want to remove this deck?"}),(0,o.jsxs)("div",{className:"deck-remove-modal-footer",children:[(0,o.jsx)("button",{className:"btn btn-text deck-remove-modal-cancel-btn",onClick:s,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-negative btn-negative-text deck-remove-modal-confirm-btn",onClick:e,children:"Remove"})]})]})}var u=t(255);const m=function({children:e,hide:s}){return(0,o.jsxs)(l.Z,{hide:s,children:[e,(0,o.jsx)("div",{className:"decks-settings-footer",children:(0,o.jsx)("button",{className:"btn btn-text decks-settings-hide-btn",onClick:s,children:"Close"})})]})};const h=function({hide:e}){const[s,t]=(0,n.useState)((()=>(0,u.T)()));function i({target:e}){const n=e.getAttribute("data-name"),i={...s[n]};switch(e.type){case"checkbox":i.value=e.checked;break;case"text":i.valid=e.validity.valid,i.value=e.value}t({...s,[n]:i})}return(0,o.jsxs)(m,{hide:function(){const t=(0,u.T)(),{cardCount:n,timeoutDuration:i,textSize:a}=s;n.valid&&(t.cardCount.value=parseInt(n.value,10)||0),i.valid&&(t.timeoutDuration.value=parseInt(i.value,10)||0),t.textSize.value=parseFloat(a.value),t.randomize=s.randomize,(0,u.z)(t),e()},children:[(0,o.jsx)("h3",{className:"modal-title",children:"Global Deck Settings"}),(0,o.jsxs)("label",{className:"decks-settings-item decks-settings-item-spaced",children:[(0,o.jsx)("span",{children:"Text size"}),(0,o.jsxs)("select",{className:"input decks-settings-select",value:s.textSize.value,onChange:function({target:e}){t({...s,textSize:{value:e.value}})},children:[(0,o.jsx)("option",{value:"0.875",children:"Small"}),(0,o.jsx)("option",{value:"1",children:"Medium"}),(0,o.jsx)("option",{value:"1.125",children:"Big"}),(0,o.jsx)("option",{value:"1.25",children:"Huge"})]})]}),(0,o.jsxs)("label",{className:"checkbox-container decks-settings-item decks-settings-item-spaced",children:[(0,o.jsx)("span",{children:"Randomize cards"}),(0,o.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:i,checked:s.randomize.value}),(0,o.jsx)("div",{className:"checkbox decks-settings-checkbox",children:(0,o.jsx)("div",{className:"checkbox-tick"})})]}),(0,o.jsxs)("label",{className:"decks-settings-item",children:[(0,o.jsx)("span",{children:"Use"}),(0,o.jsx)("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",onChange:i,pattern:"[0-9]*$",value:s.cardCount.value}),(0,o.jsx)("span",{children:"cards per study session"}),(0,o.jsx)("div",{className:"decks-settings-message",children:"Please provide a valid whole number."})]}),(0,o.jsxs)("label",{className:"decks-settings-item",children:[(0,o.jsx)("span",{children:"Reveal answer after"}),(0,o.jsx)("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",onChange:i,pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",value:s.timeoutDuration.value}),(0,o.jsx)("span",{children:"seconds"}),(0,o.jsxs)("div",{className:"decks-settings-message",children:["Please provide a valid whole number.",(0,o.jsx)("br",{})," Minimal accepted value is 5 seconds."]})]})]})};const b=function({deck:e,hide:s}){const t=e.settings||{...(0,u.T)(),useGlobalSettings:{value:!0}},[i,a]=(0,n.useState)((()=>structuredClone(t))),d=i.useGlobalSettings.value;function l({target:e}){const s=e.getAttribute("data-name"),t={...i[s]};switch(e.type){case"checkbox":t.value=e.checked;break;case"text":t.valid=e.validity.valid,t.value=e.value}a({...i,[s]:t})}return(0,o.jsxs)(m,{hide:function(){const{cardCount:n,timeoutDuration:a}=i;n.valid&&(t.cardCount.value=parseInt(n.value,10)||0),a.valid&&(t.timeoutDuration.value=parseInt(a.value,10)||0),t.useGlobalSettings=i.useGlobalSettings,t.randomize=i.randomize,e.settings=t,(0,c.C2)(e),s()},children:[(0,o.jsx)("h3",{className:"modal-title",children:"Deck Settings"}),(0,o.jsxs)("label",{className:"decks-settings-item decks-settings-item-spaced checkbox-container",children:[(0,o.jsx)("span",{children:"Use global settings"}),(0,o.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"useGlobalSettings",onChange:l,defaultChecked:d}),(0,o.jsx)("div",{className:"checkbox decks-settings-checkbox",children:(0,o.jsx)("div",{className:"checkbox-tick"})})]}),(0,o.jsxs)("label",{className:"decks-settings-item decks-settings-item-spaced"+(d?" disabled":""),children:[(0,o.jsx)("span",{children:"Randomize cards"}),(0,o.jsx)("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:l,checked:i.randomize.value,disabled:d}),(0,o.jsx)("div",{className:"checkbox decks-settings-checkbox",children:(0,o.jsx)("div",{className:"checkbox-tick"})})]}),(0,o.jsxs)("label",{className:"decks-settings-item"+(d?" disabled":""),children:[(0,o.jsx)("span",{children:"Use"}),(0,o.jsx)("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",onChange:l,pattern:"[0-9]*$",value:i.cardCount.value,disabled:d}),(0,o.jsx)("span",{children:"cards per study session"}),(0,o.jsx)("div",{className:"decks-settings-message",children:"Please provide a valid whole number."})]}),(0,o.jsxs)("label",{className:"decks-settings-item"+(d?" disabled":""),children:[(0,o.jsx)("span",{children:"Reveal answer after"}),(0,o.jsx)("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",onChange:l,pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",value:i.timeoutDuration.value,disabled:d}),(0,o.jsx)("span",{children:"seconds"}),(0,o.jsxs)("div",{className:"decks-settings-message",children:["Please provide a valid whole number.",(0,o.jsx)("br",{})," Minimal accepted value is 5 seconds."]})]})]})};const x=function({children:e}){const[{id:s,visible:t},i]=(0,n.useState)({id:"",visible:!1}),c=(0,n.useCallback)((function({target:e}){const t=e.closest(".dropdown-container");let n=!0;t&&t.id===s&&(n=e.closest(".dropdown-btn"));n&&(l.current&&i({id:s,visible:!1}),window.removeEventListener("click",c))}),[s]),l=(0,n.useRef)(!1);return(0,n.useEffect)((()=>(l.current=!0,i({visible:t,id:(0,a.zO)()}),()=>{l.current=!1,window.removeEventListener("click",c)})),[]),(0,o.jsxs)("div",{id:s,className:"dropdown-container",children:[(0,o.jsx)("button",{className:"btn btn-icon",onClick:function(){t?window.removeEventListener("click",c):window.addEventListener("click",c),i({id:s,visible:!t})},children:(0,o.jsx)(d.Z,{name:"dots-vertical"})}),t&&(0,o.jsx)("div",{className:"dropdown",children:e})]})};function k({deck:e,showDialog:s,showDeckSettings:t,exportDeck:n}){const c=(0,a.Vb)(e.cards).length,l=e.cards.filter((e=>e.level>1)).length;return(0,o.jsxs)("li",{className:"deck",children:[(0,o.jsxs)("div",{className:"deck-body",children:[(0,o.jsxs)("div",{className:"deck-main-content",children:[(0,o.jsx)("h2",{className:"deck-title",children:e.title}),e.description&&(0,o.jsx)("p",{className:"deck-description",children:e.description}),c?(0,o.jsxs)("div",{className:"deck-info",children:[c," card",c>1?"s":""," to review"]}):null,(0,o.jsxs)("div",{className:"deck-info",children:[(0,o.jsxs)("div",{className:"deck-info-item",children:[l," / ",e.cards.length," card",e.cards.length>1&&"s"," learned"]}),(0,o.jsx)("div",{className:"deck-info-item",children:function(){const s=e.modifiedAt?"Modified":"Created",t=Date.now()-(e.modifiedAt||e.createdAt),n=6e4,i=36e5,a=24*i,c=30*a,d=365.25*a;if(t<n)return`${s} just now`;const l=function(e,s){return(t,n)=>{const i=Math.round(e/n);return`${s} ${i} ${t}${i>1?"s":""} ago`}}(t,s);return t<i?l("minute",n):t<a?l("hour",i):t<c?l("day",a):t<d?l("month",c):l("year",d)}()})]})]}),(0,o.jsxs)(x,{children:[(0,o.jsxs)("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>t(e),children:[(0,o.jsx)(d.Z,{name:"settings"}),(0,o.jsx)("span",{children:"Settings"})]}),(0,o.jsxs)(i.rU,{to:`/decks/${e.id}`,className:"btn btn-icon-text dropdown-btn",children:[(0,o.jsx)(d.Z,{name:"list"}),(0,o.jsx)("span",{children:"Status"})]}),(0,o.jsxs)(i.rU,{to:`/decks/${e.id}/edit`,className:"btn btn-icon-text dropdown-btn",children:[(0,o.jsx)(d.Z,{name:"edit"}),(0,o.jsx)("span",{children:"Edit"})]}),(0,o.jsxs)("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>n(e),children:[(0,o.jsx)(d.Z,{name:"export"}),(0,o.jsx)("span",{children:"Export"})]}),(0,o.jsxs)("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>s(e.id),children:[(0,o.jsx)(d.Z,{name:"remove"}),(0,o.jsx)("span",{children:"Remove"})]})]})]}),(0,o.jsxs)("div",{className:"deck-btn-container",children:[e.hasCardsToLearn?(0,o.jsx)(i.rU,{to:`/decks/${e.id}/learn`,className:"btn btn-text deck-btn",children:"Learn"}):(0,o.jsx)("span",{className:"btn btn-text deck-btn disabled",children:"Learn"}),e.hasCardsToReview?(0,o.jsx)(i.rU,{to:`/decks/${e.id}/review`,className:"btn btn-text deck-btn",children:"Review"}):(0,o.jsx)("span",{className:"btn btn-text deck-btn disabled",children:"Review"}),(0,o.jsx)(i.rU,{to:`/decks/${e.id}/practice`,className:"btn btn-text deck-btn",children:"Practice"})]})]})}const p=function(){const[e,s]=(0,n.useState)([]),[l,u]=(0,n.useState)({visible:!1}),[m,x]=(0,n.useState)(!0);function p(e){u({deckRemoveModalVisible:!0,id:e})}function v(e){u({deckSettingsVisible:!0,deck:e})}function j(){u({})}async function g(e){const[{default:s},{default:n}]=await Promise.all([t.e(162).then(t.t.bind(t,162,23)),t.e(733).then(t.t.bind(t,733,23))]),i=new n,a=i.folder(e.title);a.file("metadata.json",JSON.stringify({title:e.title,description:e.description},null,2)),e.cards.forEach(((e,s)=>{const t=e.front.attachment;let n;t&&(t.blob?(n={type:t.type,description:t.description,mimeType:t.blob.type,blobName:t.blob.name},a.file(t.blob.name,new Blob([t.blob],{type:t.blob.type}))):n=t),a.file(`${s}.json`,JSON.stringify({...e,front:{...e.front,attachment:n}},null,2))}));s(await i.generateAsync({type:"blob"}),`${e.title}.zip`)}return(0,n.useEffect)((()=>{(0,c.GT)().then((e=>{s(e.map((e=>(e.hasCardsToLearn=!!(0,a.OZ)(e.cards).length,e.hasCardsToReview=!!(0,a.Vb)(e.cards).length,e)))),x(!1),(0,a.Dk)("Your decks")}))}),[]),(0,o.jsxs)("div",{className:"container max-width-limit",children:[(0,o.jsxs)("div",{className:"decks-header",children:[(0,o.jsx)("h1",{className:"decks-title",children:"Your Decks"}),(0,o.jsx)(i.rU,{to:"/decks/create",className:"btn deck-create-link",children:"Create"})]}),(0,o.jsxs)("div",{className:"decks-top-bar",children:[(0,o.jsxs)("label",{className:"btn btn-icon-text decks-top-bar-item deck-import-input-container",children:[(0,o.jsx)(d.Z,{name:"import"}),(0,o.jsx)("span",{children:"Import"}),(0,o.jsx)("input",{type:"file",className:"sr-only",onChange:async function({target:n}){const[i]=n.files,{default:d}=await t.e(733).then(t.t.bind(t,733,23)),l=await d.loadAsync(i),o={id:(0,a.zO)(),title:"",description:"",createdAt:Date.now(),cards:[]};for(const[e,s]of Object.entries(l.files))if(e.endsWith("/metadata.json")){const e=JSON.parse(await s.async("string"));Object.assign(o,e)}else if(e.endsWith(".json")){const e=JSON.parse(await s.async("string")),t=e.front.attachment;if(e.id=(0,a.zO)(),t&&t.blobName){const{blobName:e}=t,s=l.files[`${o.title}/${e}`];t.blob=new File([await s.async("blob")],e,{type:t.mimeType}),delete t.blobName,delete t.mimeType}o.cards.push(e)}s([...e,o]),(0,c.C2)(o),n.value=""}})]}),(0,o.jsxs)("button",{className:"btn btn-icon-text decks-top-bar-item",onClick:function(){u({settingsVisible:!0})},children:[(0,o.jsx)(d.Z,{name:"settings"}),(0,o.jsx)("span",{children:"Settings"})]})]}),m?"":e.length?(0,o.jsx)("ul",{className:"decks",children:function(e){return e.map((e=>(0,o.jsx)(k,{deck:e,showDialog:p,showDeckSettings:v,exportDeck:g},e.id)))}(e)}):(0,o.jsx)("h2",{className:"decks-message",children:"You have no decks"}),l.deckRemoveModalVisible&&(0,o.jsx)(r,{removeDeck:function(){const t=function(e,s){return e.findIndex((({id:e})=>e===s))}(e,l.id);e.splice(t,1),s([...e]),(0,c.$P)(l.id),j()},cancelRemoval:j}),l.settingsVisible&&(0,o.jsx)(h,{hide:j}),l.deckSettingsVisible&&(0,o.jsx)(b,{hide:j,deck:l.deck})]})}},997:(e,s,t)=>{t.d(s,{Z:()=>a});var n=t(294),i=t(893);const a=function({className:e,hide:s,children:t}){const a=(0,n.useCallback)((function({key:e}){"Escape"===e&&s()}),[]);return(0,n.useEffect)((()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)})),[]),(0,i.jsx)("div",{className:"modal-mask",onClick:function({target:e,currentTarget:t}){e===t&&s()},children:(0,i.jsx)("div",{className:"modal"+(e?` ${e}`:""),children:t})})}},446:(e,s,t)=>{t.d(s,{$P:()=>d,C2:()=>c,GT:()=>i,VC:()=>a});const n=new(t(520).ZP)("nimus-cards");function i(){return n.decks.toArray().then(l).catch((e=>{console.log(e)}))}function a(e){return n.decks.get(e)}function c(e){n.decks.put(e).catch((e=>{console.log(e)}))}function d(e){n.decks.delete(e).catch((e=>{console.log(e)}))}function l(e){return e.sort(((e,s)=>e.createdAt<s.createdAt?1:e.createdAt>s.createdAt?-1:0))}n.version(1).stores({decks:"id"})},255:(e,s,t)=>{t.d(s,{T:()=>i,z:()=>a});let n={textSize:{value:1},randomize:{value:!0},cardCount:{value:10},timeoutDuration:{value:""},...JSON.parse(localStorage.getItem("nimus-cards-settings"))};function i(){return structuredClone(n)}function a(e){n={...n,...e},localStorage.setItem("nimus-cards-settings",JSON.stringify(n))}}}]);